import{a as m,j as e}from"./index-C6mMUq5w.js";import{a as h}from"./index-xsH4HHeE.js";import{a as x}from"./index-CjQjypWB.js";import{C as v,a as T}from"./CRow-B8XJxCvJ.js";import{C as B,a as R}from"./CCardBody-gDBQUuD8.js";import{C as D}from"./CCardHeader-D174EtRf.js";import{C as L}from"./CCardTitle-DOZAZvAL.js";import{C as P,a as F,b as j,c as r,d as S,e as t}from"./CTable-Bo38vagw.js";import{a as z}from"./index.esm-BFnYFe3D.js";const V=()=>{const[f,b]=m.useState([]),[p,C]=m.useState({}),[k,g]=m.useState({});m.useEffect(()=>{(async()=>{try{const a=x.get("login"),o=(await h.get("https://be-mirai.valla.cloud/api/company/calon-documents",{headers:{Authorization:`Bearer ${a}`}})).data.data||[];b(o);for(const d of o){const i={passport:!1,hasil_interview:!1,id_dipnaker:!1,medical_check_up:!1,sert_ktkln:!1,pas_foto:null};for(const n of Object.keys(i))try{const u=await h.post("https://be-mirai.valla.cloud/api/adm/usr/viewPDF",{userid:d.userid,columns:n,table:"tbl_documents"},{headers:{Authorization:`Bearer ${a}`},responseType:"blob"});if(n==="pas_foto"){const y=URL.createObjectURL(u.data);g(U=>({...U,[d.userid]:y})),i[n]=!0}else u.data.size>0&&(i[n]=!0)}catch{}C(n=>({...n,[d.userid]:i}))}}catch(a){console.error("Gagal mengambil data pengguna:",a)}})()},[]);const w=async(s,a)=>{try{const c=x.get("login"),o=await h.post("https://be-mirai.valla.cloud/api/adm/usr/viewPDF",{userid:a,columns:s,table:"tbl_documents"},{headers:{Authorization:`Bearer ${c}`},responseType:"blob"}),d=new Blob([o.data],{type:"application/pdf"}),i=URL.createObjectURL(d);window.open(i,"_blank")}catch(c){console.error(`Gagal membuka dokumen ${s}:`,c)}},l=(s,a)=>{var o;return((o=p==null?void 0:p[s])==null?void 0:o[a])?e.jsx(z,{size:"sm",color:"info",onClick:()=>w(a,s),children:"View"}):e.jsx("span",{className:"text-danger",children:"Belum diisi"})},_=s=>{const a=k[s];return a?e.jsx("img",{src:a,alt:"Pas Foto",style:{width:"60px",borderRadius:"4px",border:"1px solid #ccc"}}):e.jsx("span",{className:"text-danger",children:"Belum diisi"})};return e.jsx(v,{children:e.jsx(T,{xs:12,children:e.jsxs(B,{children:[e.jsx(D,{children:e.jsx(L,{children:"Dokumen Administrasi - Semua Pengguna"})}),e.jsx(R,{children:e.jsxs(P,{responsive:!0,hover:!0,children:[e.jsx(F,{children:e.jsxs(j,{children:[e.jsx(r,{children:"No"}),e.jsx(r,{children:"Nama"}),e.jsx(r,{children:"Passport"}),e.jsx(r,{children:"Hasil Interview"}),e.jsx(r,{children:"Id Dipnaker"}),e.jsx(r,{children:"Medical Check Up"}),e.jsx(r,{children:"Sertifikat KTKLN"}),e.jsx(r,{children:"Pas Foto"})]})}),e.jsx(S,{children:f.map((s,a)=>e.jsxs(j,{children:[e.jsx(t,{children:a+1}),e.jsx(t,{children:s.nama}),e.jsx(t,{children:l(s.userid,"passport")}),e.jsx(t,{children:l(s.userid,"hasil_interview")}),e.jsx(t,{children:l(s.userid,"id_dipnaker")}),e.jsx(t,{children:l(s.userid,"medical_check_up")}),e.jsx(t,{children:l(s.userid,"sert_ktkln")}),e.jsx(t,{children:_(s.userid)})]},s.userid))})]})})]})})})};export{V as default};
