import{a as p,x as U,q as F,j as a}from"./index-C6mMUq5w.js";import{a as f}from"./index-xsH4HHeE.js";import{a as h}from"./index-CjQjypWB.js";import{C as P,a as _}from"./CCardBody-gDBQUuD8.js";import{C as A}from"./CCardHeader-D174EtRf.js";import{C as L}from"./CCardTitle-DOZAZvAL.js";import{C as x,a as t}from"./CRow-B8XJxCvJ.js";import{C as j}from"./CFormLabel-CZasDc-G.js";import{C as k}from"./CFormText-baHXDdj0.js";import{a as b}from"./index.esm-BFnYFe3D.js";const B="https://be-mirai.valla.cloud/api/adm/usr/viewPDF",N="tbl_documents",H=()=>{const[c,g]=p.useState(null),{user_id:n}=U(),[l,C]=p.useState(null),w=F();p.useEffect(()=>{(async()=>{var e;try{const r=h.get("login"),o=await f.get(`https://be-mirai.valla.cloud/api/adm/usr/administrasi/${n}`,{headers:{Authorization:`Bearer ${r}`}});C(((e=o.data)==null?void 0:e.data)||{})}catch(r){console.error("Gagal mengambil data dokumen:",r)}})(),y("foto",g)},[n]);const y=async(s,e)=>{try{const r=h.get("login"),o=await f.post(`https://be-mirai.valla.cloud/api/adm/usr/${s}`,{userid:n},{headers:{Authorization:`Bearer ${r}`},responseType:"blob"}),d=URL.createObjectURL(o.data);e(d)}catch(r){console.error(`Gagal menampilkan gambar ${s}:`,r)}},D=async s=>{try{const e=h.get("login"),r=await fetch(B,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({userid:n,columns:s,table:N})});if(!r.ok){let m="Gagal membuka dokumen";try{const u=await r.json();m=(u==null?void 0:u.message)||m}catch{}throw new Error(m)}const o=await r.blob();if(o.size===0)throw new Error("File kosong / tidak ditemukan");const d=URL.createObjectURL(o);window.open(d,"_blank","noopener,noreferrer"),setTimeout(()=>URL.revokeObjectURL(d),6e4)}catch(e){console.error(`View PDF error (${s}):`,e),alert(e.message||"Gagal membuka dokumen")}},R=s=>{const e=l==null?void 0:l[s];return e?typeof e=="object"&&("data"in e||(e==null?void 0:e.type)==="Buffer")&&Array.isArray(e.data)?e.data.length>0:!0:!1},i=(s,e)=>{const r=R(e);return a.jsxs(x,{className:"mb-3",children:[a.jsx(t,{md:4,children:a.jsx(j,{children:s})}),a.jsx(t,{md:4,children:a.jsx(k,{className:r?"text-success":"text-danger",children:r?"✔️ Sudah diupload":"❌ Belum diupload"})}),a.jsx(t,{md:4,children:r&&a.jsx(b,{size:"sm",color:"info",onClick:()=>D(e),children:"View"})})]},e)};return a.jsxs(P,{children:[a.jsx(A,{children:a.jsxs(L,{children:["Dokumen Administrasi - ",n]})}),a.jsxs(_,{children:[a.jsxs(x,{className:"mb-3",children:[a.jsx(t,{md:4,children:a.jsx(j,{children:"Pas Foto"})}),a.jsx(t,{md:4,children:a.jsx(k,{className:c?"text-success":"text-danger",children:c?"✔️ Sudah diupload":"❌ Belum diupload"})}),a.jsx(t,{md:4,children:c&&a.jsx("img",{src:c,alt:"Pas Foto",style:{width:"100px",borderRadius:"8px",border:"1px solid #ccc"}})})]}),i("Scan Passport","passport"),i("Hasil Interview","hasil_interview"),i("ID Dipnaker","id_dipnaker"),i("Medical Check Up","medical_check_up"),i("Sertifikat KTKLN","sert_ktkln"),a.jsx(x,{className:"mt-3",children:a.jsx(t,{className:"d-flex justify-content-end",children:a.jsx(b,{color:"secondary",onClick:()=>w("/admin"),children:"Kembali ke Dashboard"})})})]})]})};export{H as default};
