import{x as D,q as F,a as h,j as a,C as T}from"./index-C6mMUq5w.js";import{a as B}from"./index-xsH4HHeE.js";import{a as g}from"./index-CjQjypWB.js";import{C as b,a as A}from"./CCardBody-gDBQUuD8.js";import{C as S}from"./CCardHeader-D174EtRf.js";import{C as E}from"./CCardTitle-DOZAZvAL.js";import{C as d,a as s}from"./CRow-B8XJxCvJ.js";import{C as r}from"./CFormLabel-CZasDc-G.js";import{C as l}from"./CFormInput-C0niFpvg.js";import{C as p}from"./CFormSelect-JH-6Ev9o.js";import{C as R}from"./CAlert-DklNaJ9p.js";import{a as k}from"./index.esm-BFnYFe3D.js";import"./CFormControlWrapper-BFmmxZq2.js";import"./CFormControlValidation-CP5S10L1.js";import"./CFormText-baHXDdj0.js";import"./DefaultLayout-G9PbBR7y.js";import"./cil-user-Dlmw-Gem.js";const z="https://be-mirai.valla.cloud/api/adm/usr/viewPDF",O=c=>`https://be-mirai.valla.cloud/api/adm/usr/biodataid/${c}`,U=["scan_akta","scan_ktp","scan_kartukeluarga","scan_ijazah_sd","scan_ijazah_smp","scan_ijazah_sma","scan_ijazah_s1","sertifikat_bahasa","sertifikat_skillworker","cv","scan_sim","dokumen_pengalaman"],i={nama:"Nama Lengkap",jenis_kelamin:"Jenis Kelamin",nomor_paspor:"Nomor Paspor",phone_number:"Nomor HP",tanggal_lahir:"Tanggal Lahir",tempat_lahir:"Tempat Lahir",nik_ktp:"NIK KTP",email:"Email",alamat:"Alamat",nama_ortu:"Nama Orang Tua",handphone_ortu:"Nomor HP Orang Tua",alamat_ortu:"Alamat Orang Tua",keterangan_jurusan:"Keterangan Jurusan",tingkat_bahasa:"Tingkat Bahasa (JLPT)",jenis_sim:"Jenis SIM",pengalaman_jepang:"Pengalaman ke Jepang"},sa=()=>{const{user_id:c}=D(),f=F(),[v,C]=h.useState(!0),[u,N]=h.useState(null),[t,y]=h.useState({nama:"",jenis_kelamin:"",nomor_paspor:"",phone_number:"",tanggal_lahir:"",tempat_lahir:"",nik_ktp:"",email:"",alamat:"",nama_ortu:"",handphone_ortu:"",alamat_ortu:"",keterangan_jurusan:"",tingkat_bahasa:"",jenis_sim:"",pengalaman_jepang:""});h.useEffect(()=>{(async()=>{try{const n=g.get("login"),{data:o}=await B.get(O(c),{headers:{Authorization:`Bearer ${n}`}}),e=(o==null?void 0:o.data)||{};N(e),y({nama:e.nama||"",jenis_kelamin:(e.jenis_kelamin||"").toUpperCase(),nomor_paspor:e.nomor_paspor||"",phone_number:e.phone_number||"",tanggal_lahir:e.tanggal_lahir?String(e.tanggal_lahir).slice(0,10):"",tempat_lahir:e.tempat_lahir||"",nik_ktp:e.nik_ktp||"",email:e.email||"",alamat:e.alamat||"",nama_ortu:e.nama_ortu||"",handphone_ortu:e.handphone_ortu||"",alamat_ortu:e.alamat_ortu||"",keterangan_jurusan:e.keterangan_jurusan||"",tingkat_bahasa:e.tingkat_bahasa||"",jenis_sim:e.jenis_sim||"",pengalaman_jepang:(e.pengalaman_jepang||"").toLowerCase()})}catch(n){console.error("Gagal mengambil data biodata:",n)}finally{C(!1)}})()},[c]);const P=m=>{const n=u==null?void 0:u[m];return n?typeof n=="object"&&("data"in n||n.type==="Buffer")&&Array.isArray(n.data)?n.data.length>0:!0:!1},L=async m=>{try{const n=g.get("login"),o={userid:c,columns:m,table:"tbl_biodata"},e=await fetch(z,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json",Accept:"application/pdf"},body:JSON.stringify(o)}),w=e.headers.get("content-type")||"";if(!e.ok&&w.includes("application/json")){const j=await e.json().catch(()=>({}));throw new Error((j==null?void 0:j.message)||"Gagal memuat PDF")}const _=await e.blob();if(_.size===0)throw new Error("File kosong / tidak ditemukan");const x=URL.createObjectURL(_);window.open(x,"_blank","noopener,noreferrer"),setTimeout(()=>URL.revokeObjectURL(x),6e4)}catch(n){console.error("View PDF error:",n),alert(n.message||"Gagal memuat PDF")}};return v?a.jsxs(b,{className:"p-4 d-flex align-items-center justify-content-center",style:{minHeight:240},children:[a.jsx(T,{}),a.jsx("div",{className:"mt-2",children:"Memuat biodata…"})]}):a.jsxs(b,{children:[a.jsx(S,{children:a.jsxs(E,{children:["Biodata Pengguna — ",c]})}),a.jsxs(A,{children:[a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.nama}),a.jsx(l,{value:t.nama,disabled:!0})]}),a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.jenis_kelamin}),a.jsxs(p,{value:t.jenis_kelamin,disabled:!0,children:[a.jsx("option",{value:"",children:"Pilih"}),a.jsx("option",{value:"L",children:"Laki-laki"}),a.jsx("option",{value:"P",children:"Perempuan"})]})]})]}),a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.nomor_paspor}),a.jsx(l,{value:t.nomor_paspor,disabled:!0})]}),a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.phone_number}),a.jsx(l,{value:t.phone_number,disabled:!0})]})]}),a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.tanggal_lahir}),a.jsx(l,{type:"date",value:t.tanggal_lahir,disabled:!0})]}),a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.tempat_lahir}),a.jsx(l,{value:t.tempat_lahir,disabled:!0})]})]}),a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.nik_ktp}),a.jsx(l,{value:t.nik_ktp,disabled:!0})]}),a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.email}),a.jsx(l,{type:"email",value:t.email,disabled:!0})]})]}),a.jsx(d,{className:"mb-3",children:a.jsxs(s,{children:[a.jsx(r,{children:i.alamat}),a.jsx(l,{value:t.alamat,disabled:!0})]})}),a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.nama_ortu}),a.jsx(l,{value:t.nama_ortu,disabled:!0})]}),a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.handphone_ortu}),a.jsx(l,{value:t.handphone_ortu,disabled:!0})]})]}),a.jsx(d,{className:"mb-4",children:a.jsxs(s,{children:[a.jsx(r,{children:i.alamat_ortu}),a.jsx(l,{value:t.alamat_ortu,disabled:!0})]})}),a.jsxs(d,{className:"mb-3",children:[a.jsxs(s,{md:6,children:[a.jsx(r,{children:i.keterangan_jurusan}),a.jsx(l,{value:t.keterangan_jurusan,disabled:!0})]}),a.jsxs(s,{md:3,children:[a.jsx(r,{children:i.tingkat_bahasa}),a.jsxs(p,{value:t.tingkat_bahasa,disabled:!0,children:[a.jsx("option",{value:"",children:"Pilih"}),a.jsx("option",{value:"W4",children:"W4"}),a.jsx("option",{value:"N3",children:"N3"}),a.jsx("option",{value:"N2",children:"N2"}),a.jsx("option",{value:"N1",children:"N1"})]})]}),a.jsxs(s,{md:3,children:[a.jsx(r,{children:i.jenis_sim}),a.jsx(l,{value:t.jenis_sim,disabled:!0})]})]}),a.jsx(d,{className:"mb-4",children:a.jsxs(s,{md:3,children:[a.jsx(r,{children:i.pengalaman_jepang}),a.jsxs(p,{value:t.pengalaman_jepang,disabled:!0,children:[a.jsx("option",{value:"",children:"Pilih"}),a.jsx("option",{value:"ya",children:"Ya"}),a.jsx("option",{value:"tidak",children:"Tidak"})]})]})}),a.jsxs(R,{color:"secondary",className:"mb-3",children:["Dokumen berikut berformat PDF. Klik ",a.jsx("strong",{children:"Lihat"})," untuk membuka file. Jika belum diunggah, akan tertera “Belum diupload”."]}),U.reduce((m,n,o)=>{const e=Math.floor(o/2);return m[e]||(m[e]=[]),m[e].push(n),m},[]).map((m,n)=>a.jsx(d,{className:"mb-3",children:m.map(o=>a.jsx(s,{md:6,className:"d-flex align-items-end",children:a.jsxs("div",{className:"w-100",children:[a.jsx(r,{children:o.replace(/_/g," ").toUpperCase()}),a.jsx("div",{children:P(o)?a.jsx(k,{color:"info",variant:"outline",size:"sm",onClick:()=>L(o),children:"Lihat"}):a.jsx("span",{className:"text-muted",children:"Belum diupload"})})]})},o))},n)),a.jsx(d,{className:"mt-4",children:a.jsx(s,{className:"d-flex justify-content-end",children:a.jsx(k,{color:"secondary",onClick:()=>f("/admin"),children:"Kembali ke Dashboard"})})})]})]})};export{sa as default};
